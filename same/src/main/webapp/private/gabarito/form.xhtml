<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	template="/WEB-INF/template/layout.xhtml">

	<ui:define name="page-name">
		Cadastro de Gabarito
	</ui:define>

	<ui:define name="page-title">
		Cadastro de Gabarito
	</ui:define>

	<ui:define name="page-subtitle">
		Módulo para a criação de gabaritos
	</ui:define>

	<ui:define name="page-image">
		<p:graphicImage library="img" name="test.svg" />
	</ui:define>

	<ui:define name="content">
	
	<div class="ui-g-12 ">
		<p:messages id="msgs" life="7000" showDetail="true"
			showSummary="true" />
	</div>
			
		<div class="ui-fluid">

			<h:form prependId="false">
				<div jsf:id="dados-gabarito">
					<div class="ui-g-12">
						<div class="ui-g-6 ui-lg-6 ui-md-8 ui-sm-12">
							<h:outputLabel for="gabarito-titulo" value="Título" />
							<p:inputText id="gabarito-titulo" required="true" label="Título"
								value="#{gabaritoCtrl.gabarito.titulo}" />
							<p:message for="gabarito-titulo" />
						</div>
					</div>

					<div class="ui-g-12">
						<div class="ui-g-6 ui-lg-6 ui-md-8 ui-sm-12">
							<h:outputLabel for="gabarito-observacao" value="Observação" />
							<p:textEditor id="gabarito-observacao" required="true"
								label="Observação" value="#{gabaritoCtrl.gabarito.observacao}">

								<f:facet name="toolbar">
									<span class="ql-formats">
										<button class="ql-bold"></button>
										<button class="ql-italic"></button>
										<button class="ql-underline"></button>
										<button class="ql-strike"></button>
									</span>
									<span class="ql-formats"> <select class="ql-font"></select>
										<select class="ql-size"></select>
									</span>
								</f:facet>


							</p:textEditor>
							<p:message for="gabarito-observacao" />
						</div>
					</div>

					<div class="ui-g-12">
						<div class="ui-g-3 ui-lg-3 ui-md-6 ui-sm-6">
							<h:outputLabel for="gabarito-qtd-questoes" value="Qtd. de questões" />
							<p:inputText id="gabarito-qtd-questoes" required="true"
								label="Qtd. de questões" value="#{gabaritoCtrl.quantidadeQuestoes}" />
							<p:message for="gabarito-qtd-questoes" />
						</div>

						<div class="ui-g-3 ui-lg-3 ui-md-6 ui-sm-6">
							<label for="gabarito-qtd-alternativas">Qtd. de alternativas</label>
							<p:inputText id="gabarito-qtd-alternativas" required="true"
								label="Qtd. de alternativas"
								value="#{gabaritoCtrl.quantidadeAlternativasPorQuestao}" />
							<p:message for="gabarito-qtd-alternativas" />
						</div>
					</div>

				</div>

				<div class="ui-g-12">
				<div class="ui-g-3 ui-lg-3 ui-md-6 ui-sm-12">
					<p:commandButton icon="fa fa-cog" value="Gerar campos do gabarito"
						action="#{gabaritoCtrl.gerarCamposGabarito()}" styleClass="btn-red"
						update="dados-gabarito, gabarito-gerada" process="@form"
						validateClient="true" />
				</div>
				</div>



			</h:form>


			<h:form id="gabarito-gerada" prependId="false">

				<div class="ui-g-12">
					<h1>#{gabaritoCtrl.gabarito.titulo}</h1>
					<h3>
						<p:outputLabel value="#{gabaritoCtrl.gabarito.observacao}"
							escape="false" />
					</h3>
					<p:repeat var="questao" value="#{gabaritoCtrl.gabarito.questoes}"
						varStatus="indiceQuestao">

						<div class="ui-g-12">

							<p:panel header="Questão #{indiceQuestao.index +1 }">

								<div class="ui-inputgroup">
									<span class="ui-inputgroup-addon"> #{indiceQuestao.index +1 } </span>
									<p:inputText value="#{questao.enunciado}" required="true"
										placeholder="Enunciado da questão #{indiceQuestao.index +1 }" />
										
										<div class="ui-inputgroup">
												<span class="ui-inputgroup-addon">
													<p:commandButton icon="fa fa-trash" styleClass="btn-red" process="gabarito-gerada"
														action="#{gabaritoCtrl.gabarito.remover(questao)}" update="gabarito-gerada"
														title="Clique para remover a questão #{indiceQuestao.index +1 }"/>
												</span>
											</div>
								</div>

								<br />

								<p:panel header="Alternativas">
									<p:repeat var="alternativa" value="#{questao.alternativas}"
										varStatus="indiceAlternativa">
										
										<div class="ui-inputgroup">
											<span class="ui-inputgroup-addon">
												#{indiceQuestao.index +1 }.#{indiceAlternativa.index +1 } </span> <span
												class="ui-inputgroup-addon"> <p:selectBooleanCheckbox
													value="#{alternativa.resposta}"
													title="Clique para marcar se esta for a respoasta correta" />
											</span>

											<p:inputText value="#{alternativa.descricao}" required="true"
												placeholder="Digite o texto da alternativa   #{indiceAlternativa.index +1 } da questão  #{indiceQuestao.index +1 }" />
												
											<div class="ui-inputgroup">
												<span class="ui-inputgroup-addon">
													<p:commandButton icon="fa fa-trash" styleClass="btn-red" process="gabarito-gerada" 
														action="#{questao.remover(alternativa)}" update="gabarito-gerada"
														title="Clique para remover a alternativa #{indiceQuestao.index +1 }.#{indiceAlternativa.index +1 }"/>
												</span>
											</div>
										</div>

										<br />
										
										<h:panelGroup rendered="#{indiceAlternativa.last}">
												<p:commandButton icon="fa fa-plus" value="Adicionar alternativa" process="@this"
													title="Clique para adicionar mais uma alternativa" style="width:200px"
													action="#{questao.adicionarAlternativaEmBranco()}" update="gabarito-gerada"/>
										</h:panelGroup>

									</p:repeat>
									
										<h:panelGroup rendered="#{empty questao.alternativas}">
												<p:commandButton icon="fa fa-plus" value="Adicionar alternativa" process="@this"
													title="Clique para adicionar mais uma alternativa" style="width:200px"
													action="#{questao.adicionarAlternativaEmBranco()}" update="gabarito-gerada"/>
										</h:panelGroup>
										
								</p:panel>
							</p:panel>

						</div>
						
						<h:panelGroup rendered="#{indiceQuestao.last}">
							<div class="ui-g-2">
								<p:commandButton icon="fa fa-plus" value="Adicionar questão"
									title="Clique para adicionar mais uma questão" style="width:200px"
									action="#{gabaritoCtrl.gabarito.adicionarQuestaoEmBranco()}"
									 update="gabarito-gerada" process="@this"/>
							</div>
						</h:panelGroup>
					</p:repeat>
					
					<h:panelGroup rendered="#{empty gabaritoCtrl.gabarito.questoes}">
						<div class="ui-g-2">
							<p:commandButton icon="fa fa-plus" value="Adicionar questão"
								title="Clique para adicionar mais uma questão" style="width:200px"
								action="#{gabaritoCtrl.gabarito.adicionarQuestaoEmBranco()}"
								 update="gabarito-gerada" process="@this"/>
						</div>
					</h:panelGroup>
					
				</div>

				<div class="ui-g-3 ui-lg-3 ui-md-6 ui-sm-12">
					<p:commandButton icon="fa fa-cloud" value="Cadastrar gabarito"
						action="#{gabaritoCtrl.salvar()}"
						rendered="#{not empty gabaritoCtrl.gabarito.questoes and gabaritoCtrl.gabarito.id eq null}"
						update="dados-gabarito, gabarito-gerada" process="@form"
						validateClient="true" title="Clique para cadastrar a gabarito"/>

					<p:commandButton icon="fa fa-cloud" value="Editar gabarito"
						action="#{gabaritoCtrl.editar()}" styleClass="btn-green"
						rendered="#{not empty gabaritoCtrl.gabarito.questoes and gabaritoCtrl.gabarito.id ne null}"
						update="dados-gabarito, gabarito-gerada" process="@form"
						validateClient="true" title="Clique para editar os dados da gabarito"/>
				</div>

			</h:form>
		</div>

	</ui:define>
</ui:composition>